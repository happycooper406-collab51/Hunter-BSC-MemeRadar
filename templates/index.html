<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hunter - æ—©é³¥çµæ‰‹åˆ†æå¹³å°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #a855f7;
            --secondary: #d946ef;
            --accent: #c084fc;
            --bg-dark: #0f0a1e;
            --bg-darker: #080510;
            --surface: rgba(30, 20, 45, 0.8);
            --surface-light: rgba(40, 30, 55, 0.6);
            --text-primary: #ffffff;
            --text-secondary: #b4a7d6;
            --border: rgba(168, 85, 247, 0.15);
            --success: #a855f7;
            --warning: #fbbf24;
            --danger: #ef4444;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* å‹•æ…‹èƒŒæ™¯ */
        .background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
        }

        .grid-pattern {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(168, 85, 247, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(168, 85, 247, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: gridMove 20s linear infinite;
        }

        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        .glow-orb {
            position: absolute;
            width: 400px;
            height: 400px;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.3;
            animation: float 8s ease-in-out infinite;
        }

        .orb-1 {
            background: var(--primary);
            top: 10%;
            left: 10%;
        }

        .orb-2 {
            background: var(--secondary);
            bottom: 10%;
            right: 10%;
            animation-delay: -4s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(30px, 30px); }
        }

        /* ä¸»å®¹å™¨ */
        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 60px;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo::before {
            content: 'â—†';
            font-size: 1.2rem;
            -webkit-text-fill-color: var(--primary);
        }

        .nav-links {
            display: flex;
            gap: 32px;
            align-items: center;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.95rem;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        .version-badge {
            background: var(--surface);
            border: 1px solid var(--border);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--primary);
        }

        .donate-badge {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--bg-dark);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }

        .donate-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(168, 85, 247, 0.4);
        }

        /* Hero Section */
        .hero {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: center;
            min-height: calc(100vh - 200px);
        }

        .hero-left h1 {
            font-size: 3.5rem;
            line-height: 1.1;
            margin-bottom: 24px;
            font-weight: 700;
        }

        .gradient-text {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero-left p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 40px;
            line-height: 1.6;
        }

        /* è¼¸å…¥è¡¨å–® */
        .input-section {
            background: var(--surface);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 32px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .form-label .required {
            color: var(--danger);
        }

        input[type="text"],
        input[type="number"],
        input[type="password"] {
            width: 100%;
            background: rgba(10, 14, 23, 0.6);
            border: 1px solid var(--border);
            padding: 14px 16px;
            border-radius: 10px;
            font-size: 0.95rem;
            color: var(--text-primary);
            transition: all 0.3s;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        input[type="password"]:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.15);
        }

        input::placeholder {
            color: rgba(136, 146, 176, 0.5);
        }

        /* Tooltip æµ®çª— */
        .tooltip-wrapper {
            position: relative;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .tooltip-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            font-size: 0.75rem;
            cursor: help;
            transition: all 0.3s;
        }

        .tooltip-icon:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: scale(1.1);
        }

        .tooltip-text {
            position: absolute;
            bottom: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%);
            background: var(--surface);
            border: 1px solid var(--border);
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 0.8rem;
            color: var(--text-secondary);
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            pointer-events: none;
        }

        .tooltip-icon:hover .tooltip-text {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-4px);
        }

        .tooltip-text::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: var(--border);
        }

        .time-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .btn-analyze {
            width: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--bg-dark);
            padding: 16px 32px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 8px;
            position: relative;
            overflow: hidden;
        }

        .btn-analyze::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: left 0.5s;
        }

        .btn-analyze:hover::before {
            left: 100%;
        }

        .btn-analyze:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(168, 85, 247, 0.4);
        }

        /* è¦–è¦ºåŒ–å€åŸŸ */
        .hero-right {
            position: relative;
            height: 500px;
        }

        .data-viz {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .viz-circle {
            position: absolute;
            border: 2px solid var(--primary);
            border-radius: 50%;
            animation: pulse 3s ease-in-out infinite;
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.3);
        }

        .viz-circle-1 {
            width: 400px;
            height: 400px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-width: 3px;
        }

        .viz-circle-2 {
            width: 300px;
            height: 300px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation-delay: -1s;
            border-width: 2px;
        }

        .viz-circle-3 {
            width: 200px;
            height: 200px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation-delay: -2s;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 0.4;
                transform: translate(-50%, -50%) scale(1);
            }
            50% {
                opacity: 0.8;
                transform: translate(-50%, -50%) scale(1.05);
            }
        }

        .data-point {
            position: absolute;
            width: 12px;
            height: 12px;
            background: var(--primary);
            border-radius: 50%;
            box-shadow: 0 0 20px var(--primary), 0 0 40px rgba(168, 85, 247, 0.5);
            animation: orbit 10s linear infinite;
        }

        .data-point:nth-child(1) { top: 20%; left: 30%; }
        .data-point:nth-child(2) { top: 40%; right: 20%; animation-delay: -5s; }
        .data-point:nth-child(3) { bottom: 30%; left: 40%; animation-delay: -7s; }
        .data-point:nth-child(4) { top: 60%; right: 40%; animation-delay: -3s; }

        @keyframes orbit {
            0% { transform: translate(0, 0); }
            25% { transform: translate(20px, -20px); }
            50% { transform: translate(0, -40px); }
            75% { transform: translate(-20px, -20px); }
            100% { transform: translate(0, 0); }
        }

        /* Results Page */
        .results-page {
            display: none;
        }

        .results-page.active {
            display: block;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .back-btn {
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .back-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .token-badge {
            background: var(--surface);
            border: 1px solid var(--border);
            padding: 10px 20px;
            border-radius: 8px;
            font-family: monospace;
            color: var(--primary);
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: var(--surface);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            padding: 28px;
            border-radius: 16px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transform: scaleX(0);
            transition: transform 0.3s;
        }

        .stat-card:hover::before {
            transform: scaleX(1);
        }

        .stat-card:hover {
            transform: translateY(-4px);
            border-color: var(--primary);
        }

        .stat-icon {
            font-size: 2rem;
            margin-bottom: 12px;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 8px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Table */
        .table-section {
            background: var(--surface);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
        }

        .table-header {
            padding: 24px 32px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-header h2 {
            font-size: 1.4rem;
            font-weight: 600;
        }

        .export-btn {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .export-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: rgba(10, 14, 23, 0.4);
        }

        th {
            padding: 16px 32px;
            text-align: left;
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            user-select: none;
            transition: color 0.3s;
        }

        th:hover {
            color: var(--primary);
        }

        .sort-indicator {
            margin-left: 8px;
            opacity: 0.5;
            font-size: 0.8em;
        }

        .sort-indicator.active {
            opacity: 1;
            color: var(--primary);
        }

        td {
            padding: 18px 32px;
            border-bottom: 1px solid var(--border);
        }

        tbody tr {
            transition: all 0.2s;
        }

        tbody tr:hover {
            background: rgba(168, 85, 247, 0.08);
        }

        tbody tr:last-child td {
            border-bottom: none;
        }

        .rank-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--bg-dark);
            border-radius: 8px;
            font-weight: 700;
        }

        .address-cell {
            font-family: monospace;
            color: var(--secondary);
        }

        .profit-positive {
            color: var(--success);
            font-weight: 700;
        }

        .status-active {
            color: var(--success);
        }

        .status-bot {
            color: #94a3b8;
            opacity: 0.6;
        }

        .status-holding {
            color: #10b981;
            font-weight: 500;
        }

        .status-sold {
            color: #60a5fa;
        }

        /* Loading */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(5, 8, 16, 0.95);
            z-index: 9999;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 24px;
        }

        .loading-overlay.active {
            display: flex;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        /* Footer */
        .footer {
            margin-top: 80px;
            padding: 40px 0;
            border-top: 1px solid var(--border);
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .footer-social {
            display: flex;
            gap: 20px;
        }

        .social-link {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s;
        }

        .social-link:hover {
            color: var(--primary);
        }

        .footer-info {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .donate-section {
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: flex-end;
        }

        .donate-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .donate-address {
            background: var(--surface);
            border: 1px solid var(--border);
            padding: 8px 16px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.85rem;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.3s;
            user-select: all;
        }

        .donate-address:hover {
            border-color: var(--primary);
            box-shadow: 0 0 12px rgba(168, 85, 247, 0.3);
        }

        /* Responsive */
        @media (max-width: 968px) {
            .hero {
                grid-template-columns: 1fr;
            }

            .hero-right {
                height: 300px;
            }

            .nav-links {
                display: none;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 640px) {
            .hero-left h1 {
                font-size: 2.5rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            th, td {
                padding: 12px 16px;
                font-size: 0.85rem;
            }

            .footer-content {
                flex-direction: column;
                gap: 24px;
                text-align: center;
            }

            .donate-section {
                align-items: center;
            }

            .donate-address {
                font-size: 0.75rem;
                word-break: break-all;
            }
        }
    </style>
</head>
<body>
    <!-- å‹•æ…‹èƒŒæ™¯ -->
    <div class="background">
        <div class="grid-pattern"></div>
        <div class="glow-orb orb-1"></div>
        <div class="glow-orb orb-2"></div>
    </div>

    <!-- Hero Page -->
    <div id="heroPage">
        <div class="container">
            <!-- Header -->
            <div class="header">
                <div class="logo">ä¼å£¹ 51</div>
                <div class="nav-links">
                    <a href="https://x.com/0x515151" target="_blank">ğŸ¦ Twitter</a>
                    <button class="donate-badge" onclick="copyDonateAddress()">ğŸ’ æ‰“è³</button>
                    <span class="version-badge">v2.0.3</span>
                </div>
            </div>

            <!-- Hero Section -->
            <div class="hero">
                <div class="hero-left">
                    <h1>
                        ç™¼ç¾<span class="gradient-text">æ—©é³¥çµæ‰‹</span><br>
                        æ‰¾å‡ºçœŸæ­£çš„ç²åˆ©è´å®¶
                    </h1>
                    <p>
                        é€éå€å¡Šéˆæ•¸æ“šåˆ†æï¼Œè¿½è¹¤ä»£å¹£æ—©æœŸè²·å®¶çš„äº¤æ˜“è¡Œç‚ºï¼Œ<br>
                        ç²¾æº–è­˜åˆ¥ç²åˆ©æ©Ÿæœƒèˆ‡æ©Ÿå™¨äººæ¨¡å¼ã€‚
                    </p>

                    <!-- è¼¸å…¥è¡¨å–® -->
                    <div class="input-section">
                        <div class="form-group">
                            <label class="form-label tooltip-wrapper">
                                Etherscan API Key <span class="required">*</span>
                                <span class="tooltip-icon">
                                    ?
                                    <span class="tooltip-text">å¾ Etherscan å–å¾—å…è²» API Key</span>
                                </span>
                            </label>
                            <input type="password" id="apiKey" placeholder="è¼¸å…¥ä½ çš„ Etherscan API Key" />
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                ä»£å¹£åˆç´„åœ°å€ <span class="required">*</span>
                            </label>
                            <input type="text" id="tokenAddress" placeholder="0x..." />
                        </div>

                        <div class="time-inputs">
                            <div class="form-group">
                                <label class="form-label tooltip-wrapper">
                                    èµ·å§‹æ™‚é–“ï¼ˆé–‹ç›¤å¾Œï¼‰
                                    <span class="tooltip-icon">
                                        ?
                                        <span class="tooltip-text">å¾é–‹ç›¤å¾Œå¤šä¹…é–‹å§‹æŠ“å–<br>ä¾‹ï¼š15åˆ†é˜ = å¾é–‹ç›¤å¾Œ15åˆ†é˜é–‹å§‹</span>
                                    </span>
                                </label>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                                    <div>
                                        <input type="number" id="startMinutes" value="0" placeholder="0" />
                                        <div style="font-size: 0.75rem; color: var(--text-tertiary); margin-top: 4px;">åˆ†é˜</div>
                                    </div>
                                    <div>
                                        <input type="number" id="startSeconds" value="0" placeholder="0" />
                                        <div style="font-size: 0.75rem; color: var(--text-tertiary); margin-top: 4px;">ç§’</div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label tooltip-wrapper">
                                    çµæŸæ™‚é–“ï¼ˆé–‹ç›¤å¾Œï¼‰
                                    <span class="tooltip-icon">
                                        ?
                                        <span class="tooltip-text">åˆ°é–‹ç›¤å¾Œå¤šä¹…çµæŸæŠ“å–<br>ä¾‹ï¼š30åˆ†é˜ = åˆ°é–‹ç›¤å¾Œ30åˆ†é˜ç‚ºæ­¢</span>
                                    </span>
                                </label>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                                    <div>
                                        <input type="number" id="endMinutes" value="1" placeholder="1" />
                                        <div style="font-size: 0.75rem; color: var(--text-tertiary); margin-top: 4px;">åˆ†é˜</div>
                                    </div>
                                    <div>
                                        <input type="number" id="endSeconds" value="0" placeholder="0" />
                                        <div style="font-size: 0.75rem; color: var(--text-tertiary); margin-top: 4px;">ç§’</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label tooltip-wrapper">
                                æ©Ÿå™¨äººé–¾å€¼
                                <span class="tooltip-icon">
                                    ?
                                    <span class="tooltip-text">ç¯©é¸é«˜é »äº¤æ˜“å¸³è™Ÿ<br>äº¤æ˜“ç­†æ•¸ > æ­¤å€¼ = æ©Ÿå™¨äºº<br>å»ºè­°ï¼š10ï¼ˆåš´æ ¼ï¼‰~ 100ï¼ˆå¯¬é¬†ï¼‰</span>
                                </span>
                            </label>
                            <input type="number" id="maxTxs" value="10" placeholder="10" />
                        </div>

                        <button class="btn-analyze" onclick="startAnalysis()">
                            ğŸš€ é–‹å§‹åˆ†æ
                        </button>
                    </div>
                </div>

                <div class="hero-right">
                    <div class="data-viz">
                        <div class="viz-circle viz-circle-1"></div>
                        <div class="viz-circle viz-circle-2"></div>
                        <div class="viz-circle viz-circle-3"></div>
                        <div class="data-point"></div>
                        <div class="data-point"></div>
                        <div class="data-point"></div>
                        <div class="data-point"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Results Page -->
    <div class="results-page" id="resultsPage">
        <div class="container">
            <div class="results-header">
                <button class="back-btn" onclick="backToHome()">
                    â† è¿”å›
                </button>
                <div class="token-badge" id="tokenInfo">Token: â€”</div>
            </div>

            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-value" id="totalTx">â€”</div>
                    <div class="stat-label">ç¸½äº¤æ˜“æ•¸</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’°</div>
                    <div class="stat-value" id="maxProfit">â€”</div>
                    <div class="stat-label">æœ€é«˜åˆ©æ½¤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ¤–</div>
                    <div class="stat-value" id="robots">â€”</div>
                    <div class="stat-label">æ©Ÿå™¨äºº</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">â±ï¸</div>
                    <div class="stat-value" id="timeRange">â€”</div>
                    <div class="stat-label">å€é–“</div>
                </div>
            </div>

            <!-- Table -->
            <div class="table-section">
                <div class="table-header">
                    <div>
                        <h2>æ—©æœŸè²·å®¶æ’è¡Œæ¦œ</h2>
                        <div id="tokenName" style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 8px;"></div>
                    </div>
                    <button class="export-btn" onclick="exportCSV()">ğŸ“¥ åŒ¯å‡º CSV</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th onclick="sortTable('address')">åœ°å€ <span class="sort-indicator" id="sort-address"></span></th>
                            <th onclick="sortTable('bnb')">BNB åˆ©æ½¤ <span class="sort-indicator" id="sort-bnb"></span></th>
                            <th onclick="sortTable('usd')">ç¸½åˆ©æ½¤ (USD) <span class="sort-indicator" id="sort-usd"></span></th>
                            <th onclick="sortTable('multiple')">å€æ•¸ <span class="sort-indicator" id="sort-multiple"></span></th>
                            <th>ç‹€æ…‹</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- å‹•æ…‹ç”Ÿæˆ -->
                    </tbody>
                </table>
            </div>

            <!-- Footer -->
            <div class="footer">
                <div class="footer-content">
                    <div class="footer-social">
                        <a href="https://x.com/0x515151" target="_blank" class="social-link">ğŸ¦ Twitter</a>
                        <a href="#" class="social-link">ğŸ“„ Docs</a>
                        <a href="#" class="social-link">v2.0.3</a>
                    </div>
                    
                    <div class="footer-info">
                        ä¼å£¹ 51 è£½ä½œ
                    </div>

                    <div class="donate-section">
                        <div class="donate-label">ğŸ’ æ‰“è³åœ°å€</div>
                        <div class="donate-address" onclick="copyDonateAddress()" title="é»æ“Šè¤‡è£½">
                            0xe0b7e35556731872B3CE18c9645D69290F428C1C
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading -->
    <!-- Loading with Progress -->
    <div class="loading-overlay" id="loading">
        <div class="spinner"></div>
        <div class="loading-text">æ­£åœ¨åˆ†æä¸­...</div>
        
        <!-- é€²åº¦é¡¯ç¤º -->
        <div style="margin-top: 30px; text-align: center; max-width: 500px;">
            <div style="background: rgba(30, 20, 45, 0.8); border: 1px solid rgba(168, 85, 247, 0.15); border-radius: 12px; padding: 20px;">
                <div id="progressStage" style="color: var(--primary); font-size: 1.1rem; margin-bottom: 12px;">åˆå§‹åŒ–...</div>
                <div id="progressMessage" style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 16px;">æº–å‚™ä¸­...</div>
                
                <!-- é€²åº¦æ¢ -->
                <div style="background: rgba(10, 14, 23, 0.6); border-radius: 8px; height: 8px; overflow: hidden; margin-bottom: 8px;">
                    <div id="progressBarFill" style="height: 100%; background: linear-gradient(90deg, var(--primary), var(--secondary)); width: 0%; transition: width 0.3s ease;"></div>
                </div>
                
                <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.85rem; color: var(--text-tertiary);">
                    <span id="progressPercent">0%</span>
                    <span id="progressDetail"></span>
                </div>
            </div>
        </div>
    </div>

    <script>
        function startAnalysis() {
            const apiKey = document.getElementById('apiKey').value;
            const address = document.getElementById('tokenAddress').value;
            const startMinutes = parseInt(document.getElementById('startMinutes').value) || 0;
            const startSeconds = parseInt(document.getElementById('startSeconds').value) || 0;
            const endMinutes = parseInt(document.getElementById('endMinutes').value) || 0;
            const endSeconds = parseInt(document.getElementById('endSeconds').value) || 0;
            const maxTxs = parseInt(document.getElementById('maxTxs').value) || 10;

            if (!apiKey || !address) {
                alert('è«‹å¡«å¯« API Key å’Œä»£å¹£åœ°å€');
                return;
            }

            // è¨ˆç®—ç¸½ç§’æ•¸
            const startTime = startMinutes * 60 + startSeconds;
            const endTime = endMinutes * 60 + endSeconds;

            if (endTime <= startTime) {
                alert('çµæŸæ™‚é–“å¿…é ˆå¤§æ–¼èµ·å§‹æ™‚é–“');
                return;
            }

            console.log('ğŸš€ é–‹å§‹åˆ†æ:', {
                tokenAddress: address,
                startTime,
                endTime,
                maxTxs
            });

            // é¡¯ç¤º loading
            document.getElementById('loading').classList.add('active');
            updateProgressUI(0, 'åˆå§‹åŒ–', 'æ­£åœ¨é€£æ¥ API...');

            // å‘¼å«ç•°æ­¥ API
            fetch('/api/analyze', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    api_key: apiKey,
                    token_address: address,
                    start_minutes: startMinutes,
                    start_seconds: startSeconds,
                    end_minutes: endMinutes,
                    end_seconds: endSeconds,
                    max_txs: maxTxs
                })
            })
            .then(response => response.json())
            .then(data => {
                console.log('ğŸ“Š API å›æ‡‰:', data);
                
                if (!data.success) {
                    console.error('âŒ API è¿”å›å¤±æ•—:', data.error);
                    alert('åˆ†æå¤±æ•—: ' + (data.error || 'æœªçŸ¥éŒ¯èª¤'));
                    document.getElementById('loading').classList.remove('active');
                    return;
                }

                // æ”¶åˆ° session_idï¼Œé–‹å§‹è¼ªè©¢é€²åº¦
                const sessionId = data.session_id;
                console.log('âœ… æ”¶åˆ° Session ID:', sessionId);
                startProgressPolling(sessionId, address, startTime, endTime);
            })
            .catch(error => {
                console.error('âŒ éŒ¯èª¤:', error);
                alert('ç¶²è·¯éŒ¯èª¤: ' + error.message);
                document.getElementById('loading').classList.remove('active');
            });
        }

        // é€²åº¦è¼ªè©¢
        let progressPollingInterval = null;

        function startProgressPolling(sessionId, tokenAddress, startTime, endTime) {
            console.log('ğŸ”„ é–‹å§‹è¼ªè©¢é€²åº¦:', sessionId);
            
            progressPollingInterval = setInterval(() => {
                fetch(`/api/progress/${sessionId}`)
                    .then(response => response.json())
                    .then(data => {
                        console.log('ğŸ“Š é€²åº¦:', data);
                        
                        if (!data) {
                            console.error('âŒ ç„¡é€²åº¦æ•¸æ“š');
                            return;
                        }

                        // æ›´æ–°é€²åº¦ UI
                        const progress = data.progress || 0;
                        const stage = data.stage || 'è™•ç†ä¸­';
                        const message = data.message || '';
                        const detail = data.completed && data.total ? 
                            `${data.completed}/${data.total}` : '';
                        
                        updateProgressUI(progress, stage, message, detail);

                        // æª¢æŸ¥æ˜¯å¦å®Œæˆ
                        if (data.status === 'completed') {
                            console.log('âœ… åˆ†æå®Œæˆï¼');
                            console.log('ğŸ“Š å®Œæ•´æ•¸æ“š:', data);
                            console.log('ğŸ“Š data.result:', data.result);
                            console.log('ğŸ“Š data.result é¡å‹:', typeof data.result);
                            console.log('ğŸ“Š data.result.buyers:', data.result && data.result.buyers);
                            console.log('ğŸ“Š data.result.buyers æ˜¯é™£åˆ—?', data.result && Array.isArray(data.result.buyers));
                            
                            stopProgressPolling();
                            
                            // ç²å–çµæœ - æ”¾å¯¬æª¢æŸ¥
                            if (data.result) {
                                console.log('âœ… æœ‰ result ç‰©ä»¶');
                                
                                // æª¢æŸ¥ buyers
                                if (data.result.buyers && Array.isArray(data.result.buyers)) {
                                    console.log(`âœ… æ‰¾åˆ° ${data.result.buyers.length} å€‹è²·å®¶`);
                                    displayAnalysisComplete(data.result, tokenAddress, startTime, endTime);
                                } else {
                                    console.error('âŒ buyers ä¸æ˜¯é™£åˆ—æˆ–ä¸å­˜åœ¨');
                                    console.error('result keys:', Object.keys(data.result));
                                    
                                    // å˜—è©¦å‚™ç”¨æ–¹æ¡ˆ
                                    if (data.result.length > 0) {
                                        console.log('âš ï¸ result æœ¬èº«æ˜¯é™£åˆ—ï¼Œç›´æ¥ä½¿ç”¨');
                                        displayAnalysisComplete({buyers: data.result}, tokenAddress, startTime, endTime);
                                    } else {
                                        alert('åˆ†æå®Œæˆä½†ç„¡è²·å®¶æ•¸æ“š');
                                        document.getElementById('loading').classList.remove('active');
                                    }
                                }
                            } else {
                                console.error('âŒ ç„¡ result ç‰©ä»¶');
                                alert('åˆ†æå®Œæˆä½†ç„¡æ•¸æ“š');
                                document.getElementById('loading').classList.remove('active');
                            }
                        } else if (data.status === 'error') {
                            console.error('âŒ åˆ†æéŒ¯èª¤');
                            stopProgressPolling();
                            alert('åˆ†æéŒ¯èª¤ï¼Œè«‹é‡è©¦');
                            document.getElementById('loading').classList.remove('active');
                        }
                    })
                    .catch(error => {
                        console.error('âŒ è¼ªè©¢éŒ¯èª¤:', error);
                    });
            }, 500);  // æ¯ 500ms è¼ªè©¢ä¸€æ¬¡
        }

        function stopProgressPolling() {
            if (progressPollingInterval) {
                clearInterval(progressPollingInterval);
                progressPollingInterval = null;
                console.log('â¹ï¸ åœæ­¢è¼ªè©¢');
            }
        }

        function displayAnalysisComplete(result, tokenAddress, startTime, endTime) {
            console.log('ğŸ‰ é¡¯ç¤ºçµæœ:', result);
            
            // éš±è— loading
            document.getElementById('loading').classList.remove('active');
            
            // åˆ‡æ›åˆ°çµæœé 
            document.getElementById('heroPage').style.display = 'none';
            document.getElementById('resultsPage').classList.add('active');

            // å®‰å…¨æª¢æŸ¥
            if (!result || !result.buyers || !Array.isArray(result.buyers)) {
                console.error('âŒ çµæœæ ¼å¼éŒ¯èª¤');
                document.getElementById('tokenInfo').textContent = `Token: ${tokenAddress.substring(0, 10)}...`;
                document.getElementById('totalTx').textContent = '0';
                document.getElementById('maxProfit').textContent = 'Ã—0';
                document.getElementById('robots').textContent = '0';
                document.getElementById('timeRange').textContent = `${startTime}-${endTime}s`;
                
                const tbody = document.getElementById('tableBody');
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; color: var(--text-secondary); padding: 40px;">æ•¸æ“šæ ¼å¼éŒ¯èª¤</td></tr>';
                return;
            }

            // å¡«å……çµ±è¨ˆæ•¸æ“š
            document.getElementById('tokenInfo').textContent = `Token: ${tokenAddress.substring(0, 10)}...`;
            document.getElementById('totalTx').textContent = result.buyers.length || '0';
            
            // Token åç¨±é¡¯ç¤º
            if (result.token_info) {
                const tokenName = result.token_info.name || '';
                const tokenSymbol = result.token_info.symbol || '';
                if (tokenName && tokenSymbol) {
                    document.getElementById('tokenName').textContent = `ğŸ“Š ${tokenName} (${tokenSymbol})`;
                }
            }
            
            // æœ€é«˜åˆ©æ½¤ - å®‰å…¨è¨ˆç®—
            let maxProfit = 0;
            if (result.buyers.length > 0) {
                const profits = result.buyers
                    .map(b => Number(b.profit_multiple) || 0)
                    .filter(p => !isNaN(p) && isFinite(p));
                
                if (profits.length > 0) {
                    maxProfit = Math.max(...profits);
                }
            }
            document.getElementById('maxProfit').textContent = `Ã—${maxProfit.toFixed(1)}`;
            
            // æ©Ÿå™¨äººæ•¸é‡ - ä½¿ç”¨æ­£ç¢ºçš„æ¬„ä½åç¨±
            const robotCount = result.buyers.filter(b => b.is_bot).length;
            document.getElementById('robots').textContent = robotCount;
            
            // æ™‚é–“å€é–“
            document.getElementById('timeRange').textContent = `${startTime}-${endTime}s`;

            // å¡«å……è¡¨æ ¼
            displayResults(result);
        }

        function startFakeProgress() {
            // ç§»é™¤å‡é€²åº¦ï¼Œæ”¹ç”¨çœŸå¯¦é€²åº¦
        }

        function stopFakeProgress() {
            // ç§»é™¤å‡é€²åº¦ï¼Œæ”¹ç”¨çœŸå¯¦é€²åº¦
        }

        function updateProgressUI(progress, stage, message, detail) {
            const progressBar = document.getElementById('progressBarFill');
            const progressPercent = document.getElementById('progressPercent');
            const progressStage = document.getElementById('progressStage');
            const progressMessage = document.getElementById('progressMessage');
            const progressDetail = document.getElementById('progressDetail');
            
            if (progressBar) progressBar.style.width = progress + '%';
            if (progressPercent) progressPercent.textContent = Math.floor(progress) + '%';
            if (progressStage) progressStage.textContent = stage;
            if (progressMessage) progressMessage.textContent = message;
            if (progressDetail && detail) progressDetail.textContent = detail;
        }

        // é¡¯ç¤ºçµæœè¡¨æ ¼
        function displayResults(data) {
            // ä¿å­˜æ•¸æ“šä¾›åŒ¯å‡ºä½¿ç”¨
            currentAnalysisData = data;
            
            const tbody = document.getElementById('tableBody');
            
            if (!data.buyers || data.buyers.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; color: var(--text-secondary);">ç„¡æ•¸æ“š</td></tr>';
                return;
            }

            tbody.innerHTML = data.buyers.map((buyer, index) => {
                // å®‰å…¨æª¢æŸ¥å’Œæ•¸å€¼è½‰æ› - ä½¿ç”¨æ­£ç¢ºçš„æ¬„ä½
                const bnbProfit = Number(buyer.bnb_profit) || 0;
                const usdProfit = Number(buyer.total_profit_usd) || 0;
                const profit = Number(buyer.profit_multiple) || 0;
                const address = buyer.address || 'æœªçŸ¥';
                const isBot = buyer.is_bot || false;
                const status = buyer.status || 'æœªçŸ¥';
                
                // åˆ¤æ–·é¡¯ç¤ºç‹€æ…‹
                let displayStatus = status;
                let statusClass = '';
                
                if (isBot) {
                    displayStatus = 'ğŸ¤– æ©Ÿå™¨äºº';
                    statusClass = 'status-bot';
                } else if (status === 'ä»æŒå€‰') {
                    displayStatus = 'âœ“ æŒå€‰ä¸­';
                    statusClass = 'status-holding';
                } else if (status === 'å·²æ¸…å€‰') {
                    displayStatus = 'â— å·²æ¸…å€‰';
                    statusClass = 'status-sold';
                }
                
                return `
                <tr>
                    <td><span class="rank-badge">${index + 1}</span></td>
                    <td class="address-cell" onclick="window.open('https://bscscan.com/address/${address}', '_blank')">
                        ${address.length >= 42 ? address.substring(0, 6) + '...' + address.substring(38) : address}
                    </td>
                    <td>${bnbProfit.toFixed(4)} BNB</td>
                    <td>$${usdProfit.toFixed(2)}</td>
                    <td class="profit-positive">Ã—${profit.toFixed(2)}</td>
                    <td class="${statusClass}">${displayStatus}</td>
                </tr>
                `;
            }).join('');
        }

        // é‡ç½®é€²åº¦
        function resetProgress() {
            fakeProgress = 0;
            updateProgressUI(0, 'åˆå§‹åŒ–...', 'æº–å‚™ä¸­...');
        }

        function backToHome() {
            document.getElementById('resultsPage').classList.remove('active');
            document.getElementById('heroPage').style.display = 'block';
        }

        function copyDonateAddress() {
            const address = '0xe0b7e35556731872B3CE18c9645D69290F428C1C';
            navigator.clipboard.writeText(address).then(() => {
                alert('âœ… æ‰“è³åœ°å€å·²è¤‡è£½ï¼');
            }).catch(() => {
                // å‚™ç”¨æ–¹æ¡ˆ
                const textarea = document.createElement('textarea');
                textarea.value = address;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('âœ… æ‰“è³åœ°å€å·²è¤‡è£½ï¼');
            });
        }

        // å…¨å±€è®Šæ•¸å­˜å„²ç•¶å‰åˆ†æçµæœ
        let currentAnalysisData = null;
        let sortColumn = null;
        let sortDirection = 'desc'; // 'asc' or 'desc'

        // æ’åºè¡¨æ ¼
        function sortTable(column) {
            if (!currentAnalysisData || !currentAnalysisData.buyers) return;
            
            // åˆ‡æ›æ’åºæ–¹å‘
            if (sortColumn === column) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn = column;
                sortDirection = 'desc';
            }
            
            // æ’åºæ•¸æ“š
            const sortedBuyers = [...currentAnalysisData.buyers].sort((a, b) => {
                let aVal, bVal;
                
                switch(column) {
                    case 'address':
                        aVal = a.address || '';
                        bVal = b.address || '';
                        return sortDirection === 'asc' ? 
                            aVal.localeCompare(bVal) : 
                            bVal.localeCompare(aVal);
                    
                    case 'bnb':
                        aVal = Number(a.bnb_profit) || 0;
                        bVal = Number(b.bnb_profit) || 0;
                        break;
                    
                    case 'usd':
                        aVal = Number(a.total_profit_usd) || 0;
                        bVal = Number(b.total_profit_usd) || 0;
                        break;
                    
                    case 'multiple':
                        aVal = Number(a.profit_multiple) || 0;
                        bVal = Number(b.profit_multiple) || 0;
                        break;
                    
                    default:
                        return 0;
                }
                
                return sortDirection === 'asc' ? aVal - bVal : bVal - aVal;
            });
            
            // æ›´æ–°æ’åºæŒ‡ç¤ºå™¨
            document.querySelectorAll('.sort-indicator').forEach(el => {
                el.textContent = '';
                el.classList.remove('active');
            });
            
            const indicator = document.getElementById(`sort-${column}`);
            if (indicator) {
                indicator.textContent = sortDirection === 'asc' ? 'â†‘' : 'â†“';
                indicator.classList.add('active');
            }
            
            // é‡æ–°æ¸²æŸ“è¡¨æ ¼
            currentAnalysisData.buyers = sortedBuyers;
            displayResults(currentAnalysisData);
        }

        // åŒ¯å‡º CSV
        function exportCSV() {
            if (!currentAnalysisData || !currentAnalysisData.buyers) {
                alert('æ²’æœ‰å¯åŒ¯å‡ºçš„æ•¸æ“š');
                return;
            }

            // å‘¼å«å¾Œç«¯ API ç”Ÿæˆ CSV
            fetch('/api/export', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(currentAnalysisData)
            })
            .then(response => response.blob())
            .then(blob => {
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `analysis_${Date.now()}.csv`;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
            })
            .catch(error => {
                console.error('åŒ¯å‡ºéŒ¯èª¤:', error);
                alert('åŒ¯å‡ºå¤±æ•—');
            });
        }
    </script>
</body>
</html>
